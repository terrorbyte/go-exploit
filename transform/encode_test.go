package transform

import (
	"testing"
)

func TestURLEncodeString(t *testing.T) {
	encoded := URLEncodeString("foo !~")

	if encoded != "%66%6f%6f%20%21%7e" {
		t.Fatal(encoded)
	}

	t.Log(encoded)
}

func TestEncodeBase64(t *testing.T) {
	encoded := EncodeBase64("foo")

	if encoded != "Zm9v" {
		t.Fatal(encoded)
	}

	t.Log(encoded)
}

func TestDecodeBase64(t *testing.T) {
	decoded := DecodeBase64("Zm9v")

	if decoded != "foo" {
		t.Fatal(decoded)
	}

	t.Log(decoded)
}

func TestTitle(t *testing.T) {
	title := Title("foo")

	if title != "Foo" {
		t.Fatal(title)
	}

	t.Log(title)
}

func TestPackLittleInt32(t *testing.T) {
	packed := PackLittleInt32(0x44434241)

	if packed != "ABCD" {
		t.Fatal(packed)
	}

	t.Log(packed)
}

func TestPackLittleInt64(t *testing.T) {
	packed := PackLittleInt64(0x4847464544434241)

	if packed != "ABCDEFGH" {
		t.Fatal(packed)
	}

	t.Log(packed)
}

func TestPackBigInt16(t *testing.T) {
	packed := PackBigInt16(0x4142)

	if packed != "AB" {
		t.Fatal(packed)
	}

	t.Log(packed)
}

func TestPackBigInt32(t *testing.T) {
	packed := PackBigInt32(0x41424344)

	if packed != "ABCD" {
		t.Fatal(packed)
	}

	t.Log(packed)
}

func TestInflate(t *testing.T) {
	compressed := "\x1f\x8b\x08\x08\xf4\xe9\x97\x66\x00\x03\x77\x61\x74\x00\x2b\x2b\xcd\xc9\x4b\xce\x48\x4d\xce\xe6\x02\x00\x3d\xf1\xb3\xf9\x0a\x00\x00\x00"
	inflated, ok := Inflate([]byte(compressed))
	if !ok {
		t.Fatal("Error decompressing data")
	}
	inflatedStr := string(inflated)
	if inflatedStr != "vulncheck\n" {
		t.Fatalf("Decompression generated unexpected string: %s", inflatedStr)
	}
}
